# ArtSource Brazil

Niche job board focused on remote roles for Brazil-based creative talent.
Built with Astro + Tailwind, static-first, zero-JS by default (small islands only where needed).

## Tech

- Astro
- Tailwind CSS
- Local data at `src/data/jobs.json`
- DOMPurify (client-side sanitization)
- Deployed to Vercel/Netlify (static build)

## Project structure

```
src/
  components/
    JobCard.astro
    CategoryFilter.astro
  data/
    jobs.json
  pages/
    index.astro
    post-a-job.astro
  styles/
    global.css
public/
  images/
  robots.txt
```

## Getting started

### Prereqs

- Node 18+ (recommended LTS)

### Install

```bash
npm install
```

### Dev server

```bash
npm run dev
```

- Local: http://localhost:4321 (or next available port)
- Hot-reload on file changes

### Build

```bash
npm run build
npm run preview  # optional: serve the built site locally
```

- Output in `dist/`

## Data: jobs.json

Single source of truth for jobs.
Each job object uses this schema:

```json
{
  "id": "string",
  "companyName": "string",
  "companyLogo": "string",
  "jobTitle": "string",
  "description": "markdown string",
  "shortDescription": "optional string (max 300 chars)",
  "applyLink": "string",
  "postedDate": "string",
  "category": "string",
  "tags": ["string"],
  "location": {
    "scope": "remote-brazil | remote-latam | remote-worldwide | hybrid | onsite",
    "note": "optional string",
    "countryCode": "optional ISO code"
  },
  "contractType": "optional CLT | PJ | B2B | Freelance | Est√°gio",
  "salary": {
    "min": "optional number",
    "max": "optional number",
    "currency": "ISO 4217 (BRL, USD, EUR)"
  }
}
```

Notes:

- `postedDate` should be ISO 8601 (e.g., `2025-11-04T09:00:00Z`).
- `companyLogo` points to a file inside `public/images/` or a full URL.
- `description` accepts Markdown. Headings/lists/links s√£o sanitizados antes de renderizar.
- `shortDescription` (opcional) exibida em cards/previews. Limite de 300 caracteres.
- `location.scope` controla como exibimos o alcance geogr√°fico (enum acima). Use `hybrid`/`onsite` apenas quando houver presen√ßa f√≠sica parcial/total.
- `location.note` (opcional) ajuda a informar faixa de hor√°rio, presen√ßa peri√≥dica etc.
- `location.countryCode` (opcional) aceita **ISO 3166-1 alpha-2** (ex.: `BR`, `PT`). Recomendado para vagas h√≠bridas/presenciais.
- `contractType` (opcional) tipo de contrato. Suporta: CLT, PJ, B2B, Freelance, Est√°gio.
- `salary` (opcional) faixa salarial. Requer `currency` (ISO 4217: BRL, USD, EUR). `min` e `max` s√£o opcionais mas pelo menos um deve existir se salary estiver presente.

### Airtable

Para detalhes completos sobre campos, mapeamentos e script de sincroniza√ß√£o, consulte **[docs/AIRTABLE_MAPPING.md](docs/AIRTABLE_MAPPING.md)**.

**Campos principais:**
- **Obrigat√≥rios:** ID, Job_Title, Company_Name, Apply_Link, Date_Posted_Original, Category, Tags, Location_Scope, Description_Short_PT
- **Opcionais:** Company_Logo_URL, Description_Short_EN, Location_Detail, Location_Country_Code, Contrato, Salario_Min, Salario_Max, Moeda
- **Gest√£o:** Status (filtrar "Ativa" no sync), Created At, Last Modified

**Categorias suportadas:** Game Dev, 3D & Animation, Design (UI/UX), VFX, Arte 3D, UX/UI

O script de sincroniza√ß√£o deve mapear esses campos para o JSON, normalizar categorias/location scopes e validar antes de exportar.

## UI features

- Sorting: newest ‚Üí oldest by `postedDate`.
- Filters: category, search (title/company/tags) and tag chips.
- URL sync: state persisted via `?category=...&q=...&tags=...`.

## SEO

- Title/description + canonical
- Open Graph/Twitter cards (default image at `public/images/og-default.svg`)
- JSON-LD (JobPosting) for each job on the homepage
- Sitemap generated by `@astrojs/sitemap` and `robots.txt` in `public/`

If you deploy to a real domain, update the `site` field in `astro.config.mjs` and the sitemap URL in `public/robots.txt`.

## Monetization (Post a Job)

Use environment variables (see `.env.example`):

```
PUBLIC_STRIPE_PAYMENT_LINK="https://buy.stripe.com/your-payment-link"
PUBLIC_JOB_FORM_URL="https://tally.so/r/your-form-id"
```

- Fill your `.env` with real values (the file is ignored by Git).
- In Stripe Payment Link settings, set the success redirect to:
  - `https://YOUR-DOMAIN/post-a-job/success`
- The success page shows a button to the external job submission form (PUBLIC_JOB_FORM_URL).

## Formatting

Prettier is configured with:

- `prettier-plugin-astro`
- `prettier-plugin-tailwindcss`

Commands:

```bash
npm run format        # writes changes
npm run format:check  # checks only
```

## Deploy

- Vercel: set the project to build with `npm run build` and serve `dist/`.
- Netlify: same build command/output; use the Astro preset if desired.

### Analytics

- Vercel Web Analytics (cookie-free)
  - Enable in Vercel Dashboard for the project
  - We include the script tag by default in `src/layouts/Layout.astro`:
    `<script defer src="/_vercel/insights/script.js"></script>`
- Plausible (optional)
  - Set `PUBLIC_PLAUSIBLE_DOMAIN` in your env (e.g., `artsourcebrazil.vercel.app` or your custom domain)
  - The script will auto-load when the env is present

## Troubleshooting

- Tailwind styles missing: ensure `tailwind.config.mjs` has `content: ['./src/**/*.{astro,html,js,jsx,md,mdx,svelte,ts,tsx,vue}']` and restart dev server.
- Logos 404: place files in `public/images` or update `companyLogo` URLs.
- Canonical/OG URLs: set the `site` in `astro.config.mjs` to your domain.
- E2E tests failing: run `npx playwright install` to download browsers.

## üìã Project Quality & Improvements

This project was 100% AI-generated and has been **professionally improved** to production standards.

### ‚úÖ Quality Status: **60-79% (Good)** - Production Ready!

**Key Improvements Implemented:**
- ‚úÖ **Type Safety**: No `@ts-nocheck`, no `any` types
- ‚úÖ **Zod Runtime Validation**: All inputs validated and sanitized
- ‚úÖ **Error Handling**: Try-catch blocks in all critical paths
- ‚úÖ **Modular Architecture**: Controllers extracted from inline scripts
- ‚úÖ **Reusable Helpers**: 15+ DOM utility functions
- ‚úÖ **Performance**: Lazy loading, debouncing, optimizations
- ‚úÖ **Test Coverage**: Unit tests for filter logic and full E2E suite
- ‚úÖ **Security**: DOMPurify sanitization + strict Content Security Policy
- ‚úÖ **Documentation**: Complete JSDoc with examples

**ÔøΩ See full details:** [IMPROVEMENTS_COMPLETED.md](./IMPROVEMENTS_COMPLETED.md)

**‚ö° Quick check:** Run `npm run check:improvements` to see current status.

### üèóÔ∏è Architecture

**Modular Controllers:**
- `src/lib/filters/sidebar-controller.ts` - Mobile sidebar management
- `src/lib/filters/orchestrator-controller.ts` - Global filter coordinator
- `src/lib/helpers/dom.ts` - Reusable DOM utilities
- `src/lib/validation/filter-schema.ts` - Zod schemas & validation
- `src/lib/constants.ts` - Centralized configuration

**Key Features:**
- Type-safe throughout with TypeScript
- Runtime validation with Zod
- XSS protection and input sanitization
- Responsive design (mobile/desktop)
- SEO optimized with JSON-LD

# artsourcebrazil
